{"version":3,"file":"useDevicePortalInput.js","sources":["../src/useDevicePortalInput.ts"],"sourcesContent":["import { useEffect, useRef, useState } from 'react'\nimport { Initiator } from './webrtc/Initiator'\n\n// @TODO: warn if one room is used by multiple useDevicePortalInput hooks more than once at the same time\n\nexport const useDevicePortalInput = (\n\troom: string,\n\tvalue: string,\n\toptions?: {\n\t\tonValueFromOutput?: (value: string) => void\n\t\twebsocketSignalingServer?: string\n\t},\n) => {\n\tconst [initiator, setInitiator] = useState<Initiator | null>(null)\n\tconst onValueFromOutputRef = useRef(options?.onValueFromOutput)\n\tonValueFromOutputRef.current = options?.onValueFromOutput\n\n\tuseEffect(() => {\n\t\tconst initiator = new Initiator(encodeURIComponent(room), {\n\t\t\tonValue: (value) => {\n\t\t\t\tonValueFromOutputRef.current?.(value)\n\t\t\t},\n\t\t\twebsocketSignalingServer: options?.websocketSignalingServer,\n\t\t})\n\t\tsetInitiator(initiator)\n\n\t\treturn () => {\n\t\t\tinitiator.destroy()\n\t\t\tsetInitiator(null)\n\t\t}\n\t}, [room, options?.websocketSignalingServer])\n\n\tuseEffect(() => {\n\t\tinitiator?.send(value)\n\t}, [value, initiator])\n}\n"],"names":["useDevicePortalInput","room","value","options","_useState","useState","_useState2","_slicedToArray","initiator","setInitiator","onValueFromOutputRef","useRef","onValueFromOutput","current","useEffect","Initiator","encodeURIComponent","onValue","_onValueFromOutputRef","call","websocketSignalingServer","destroy","send"],"mappings":";;;;AAGA;;AAEO,IAAMA,oBAAoB,GAAG,SAAvBA,oBAAoBA,CAChCC,IAAY,EACZC,KAAa,EACbC,OAGC,EACG;AACJ,EAAA,IAAAC,SAAA,GAAkCC,QAAQ,CAAmB,IAAI,CAAC;IAAAC,UAAA,GAAAC,cAAA,CAAAH,SAAA,EAAA,CAAA,CAAA;AAA3DI,IAAAA,SAAS,GAAAF,UAAA,CAAA,CAAA,CAAA;AAAEG,IAAAA,YAAY,GAAAH,UAAA,CAAA,CAAA,CAAA;EAC9B,IAAMI,oBAAoB,GAAGC,MAAM,CAACR,OAAO,KAAPA,IAAAA,IAAAA,OAAO,KAAPA,MAAAA,GAAAA,MAAAA,GAAAA,OAAO,CAAES,iBAAiB,CAAC;EAC/DF,oBAAoB,CAACG,OAAO,GAAGV,OAAO,aAAPA,OAAO,KAAA,MAAA,GAAA,MAAA,GAAPA,OAAO,CAAES,iBAAiB;AAEzDE,EAAAA,SAAS,CAAC,YAAM;IACf,IAAMN,WAAS,GAAG,IAAIO,SAAS,CAACC,kBAAkB,CAACf,IAAI,CAAC,EAAE;AACzDgB,MAAAA,OAAO,EAAE,SAATA,OAAOA,CAAGf,OAAK,EAAK;AAAA,QAAA,IAAAgB,qBAAA;AACnB,QAAA,CAAAA,qBAAA,GAAAR,oBAAoB,CAACG,OAAO,MAAAK,IAAAA,IAAAA,qBAAA,KAA5BA,MAAAA,IAAAA,qBAAA,CAAAC,IAAA,CAAAT,oBAAoB,EAAWR,OAAK,CAAC;OACrC;AACDkB,MAAAA,wBAAwB,EAAEjB,OAAO,KAAA,IAAA,IAAPA,OAAO,KAAA,MAAA,GAAA,MAAA,GAAPA,OAAO,CAAEiB;AACpC,KAAC,CAAC;IACFX,YAAY,CAACD,WAAS,CAAC;AAEvB,IAAA,OAAO,YAAM;MACZA,WAAS,CAACa,OAAO,EAAE;MACnBZ,YAAY,CAAC,IAAI,CAAC;KAClB;AACF,GAAC,EAAE,CAACR,IAAI,EAAEE,OAAO,KAAA,IAAA,IAAPA,OAAO,KAAA,MAAA,GAAA,MAAA,GAAPA,OAAO,CAAEiB,wBAAwB,CAAC,CAAC;AAE7CN,EAAAA,SAAS,CAAC,YAAM;IACfN,SAAS,KAAA,IAAA,IAATA,SAAS,KAATA,MAAAA,IAAAA,SAAS,CAAEc,IAAI,CAACpB,KAAK,CAAC;AACvB,GAAC,EAAE,CAACA,KAAK,EAAEM,SAAS,CAAC,CAAC;AACvB;;;;"}