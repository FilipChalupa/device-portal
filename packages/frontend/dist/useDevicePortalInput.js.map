{"version":3,"file":"useDevicePortalInput.js","sources":["../src/useDevicePortalInput.ts"],"sourcesContent":["import { useEffect, useRef, useState } from 'react'\nimport { Initiator } from './webrtc/Initiator'\n\n// @TODO: warn if one room is used by multiple useDevicePortalInput hooks more than once at the same time\n\nexport const useDevicePortalInput = (\n\troom: string,\n\tvalue: string,\n\toptions?: {\n\t\tonValueFromOutput?: (value: string) => void\n\t\twebsocketSignalingServer?: string\n\t},\n) => {\n\tconst [initiator, setInitiator] = useState<Initiator | null>(null)\n\tconst onValueFromOutputRef = useRef(options?.onValueFromOutput)\n\tonValueFromOutputRef.current = options?.onValueFromOutput\n\n\tuseEffect(() => {\n\t\tconst initiator = new Initiator(encodeURIComponent(room), {\n\t\t\tonValue: (value) => {\n\t\t\t\tonValueFromOutputRef.current?.(value)\n\t\t\t},\n\t\t\twebsocketSignalingServer: options?.websocketSignalingServer,\n\t\t})\n\t\tsetInitiator(initiator)\n\n\t\treturn () => {\n\t\t\tinitiator.destroy()\n\t\t\tsetInitiator(null)\n\t\t}\n\t}, [room, options?.websocketSignalingServer])\n\n\tuseEffect(() => {\n\t\tinitiator?.send(value)\n\t}, [value, initiator])\n}\n"],"names":[],"mappings":";;;AAGA;IAEa,oBAAoB,GAAG,UACnC,IAAY,EACZ,KAAa,EACb,OAGC,EAAA;IAEK,IAAA,EAAA,GAA4B,QAAQ,CAAmB,IAAI,CAAC,EAA3D,SAAS,GAAA,EAAA,CAAA,CAAA,CAAA,EAAE,YAAY,GAAA,EAAA,CAAA,CAAA,CAAoC;AAClE,IAAA,IAAM,oBAAoB,GAAG,MAAM,CAAC,OAAO,KAAA,IAAA,IAAP,OAAO,KAAA,MAAA,GAAA,MAAA,GAAP,OAAO,CAAE,iBAAiB,CAAC;IAC/D,oBAAoB,CAAC,OAAO,GAAG,OAAO,KAAA,IAAA,IAAP,OAAO,KAAP,MAAA,GAAA,MAAA,GAAA,OAAO,CAAE,iBAAiB;AAEzD,IAAA,SAAS,CAAC,YAAA;QACT,IAAM,SAAS,GAAG,IAAI,SAAS,CAAC,kBAAkB,CAAC,IAAI,CAAC,EAAE;YACzD,OAAO,EAAE,UAAC,KAAK,EAAA;;AACd,gBAAA,CAAA,EAAA,GAAA,oBAAoB,CAAC,OAAO,MAAG,IAAA,IAAA,EAAA,KAAA,MAAA,GAAA,MAAA,GAAA,EAAA,CAAA,IAAA,CAAA,oBAAA,EAAA,KAAK,CAAC;aACrC;AACD,YAAA,wBAAwB,EAAE,OAAO,KAAA,IAAA,IAAP,OAAO,KAAP,MAAA,GAAA,MAAA,GAAA,OAAO,CAAE,wBAAwB;AAC3D,SAAA,CAAC;QACF,YAAY,CAAC,SAAS,CAAC;QAEvB,OAAO,YAAA;YACN,SAAS,CAAC,OAAO,EAAE;YACnB,YAAY,CAAC,IAAI,CAAC;AACnB,SAAC;AACF,KAAC,EAAE,CAAC,IAAI,EAAE,OAAO,KAAA,IAAA,IAAP,OAAO,KAAA,MAAA,GAAA,MAAA,GAAP,OAAO,CAAE,wBAAwB,CAAC,CAAC;AAE7C,IAAA,SAAS,CAAC,YAAA;QACT,SAAS,KAAA,IAAA,IAAT,SAAS,KAAT,MAAA,GAAA,MAAA,GAAA,SAAS,CAAE,IAAI,CAAC,KAAK,CAAC;AACvB,KAAC,EAAE,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;AACvB;;;;"}